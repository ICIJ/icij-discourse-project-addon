<script type="text/discourse-plugin" version="0.8">
    const container = Discourse.__container__;
    const route = container.lookup("route:application");
    let groupNames = []

    function collectGroupNames() {
      let gn = []
      // Collect from current group (if any)
      gn.push(route.controllerFor('group').get('model.name'))
      // Collect from current topic (if any)
      gn = gn.concat(route.controllerFor('topic').get('model.category.group_names') || [])
      // Return unique and non-nul values
      return _.chain(gn).compact().unique().value()
    }

    api.decorateWidget("home-logo:after", helper => {

      helper.widget.appEvents.on('page:changed', () => {
        groupNames = collectGroupNames()
        helper.widget.scheduleRerender();
      });

      const items = _.map(groupNames, group_name => {
        const href = '/groups/' + group_name + '/categories'
        return helper.h('a.header-projects-item', { href }, group_name)
      });

      return helper.h('div.header-projects', items[0]);
    });
</script>
